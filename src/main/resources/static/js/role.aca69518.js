(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["role"],{"0187":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"j",(function(){return s})),a.d(t,"h",(function(){return c})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return l})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return p}));a("99af");var r=a("b775"),o={list:"/sys/role/list",add:"/sys/role/add",update:"/sys/role/update",remove:"/sys/role/remove",toggleState:"/sys/role/toggle-state",detail:"/sys/role/detail",listNoResources:"/sys/role/list-no-resources",listHaveResources:"/sys/role/list-have-resources",addRoleResources:"/sys/role/add-role-resources",delRoleResources:"/sys/role/del-role-resources"};function n(e){return Object(r["b"])({url:o.list,method:"post",data:e})}function i(e){return Object(r["b"])({url:o.add,method:"post",data:e})}function s(e,t){return Object(r["b"])({url:"".concat(o.update,"/").concat(e),method:"post",data:t})}function c(e){return Object(r["b"])({url:"".concat(o.remove,"/").concat(e),method:"get"})}function d(e){return Object(r["b"])({url:"".concat(o.toggleState,"/").concat(e),method:"get"})}function l(e){return Object(r["b"])({url:"".concat(o.detail,"/").concat(e),method:"get"})}function u(e,t){return Object(r["b"])({url:"".concat(o.listNoResources,"/").concat(e),method:"post",data:t})}function m(e,t){return Object(r["b"])({url:"".concat(o.listHaveResources,"/").concat(e),method:"post",data:t})}function h(e,t){return Object(r["b"])({url:"".concat(o.addRoleResources,"/").concat(e),method:"post",data:t})}function p(e,t){return Object(r["b"])({url:"".concat(o.delRoleResources,"/").concat(e),method:"post",data:t})}},"1afd":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{ref:"searchForm",attrs:{layout:"inline",form:e.form}},[a("a-row",{attrs:{gutter:20}},[e._l(e.searchFields,(function(t,r){return r<e.size?a("a-col",{key:r,attrs:{md:e.cmd,sm:24}},[a("a-form-item",{attrs:{label:t.name}},[t.type&&"input"!==t.type?"select"===t.type?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+t.name}},e._l(t.list,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(e._s(t.label?t.label:t.value)+" ")])})),1):"date"===t.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+t.name}}):"datetime"===t.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{"show-time":"",placeholder:"请选择"+t.name}}):"radio"===t.type?a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}]},e._l(t.list,(function(t,r){return a("a-radio",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(" "+e._s(t.label?t.label:t.value)+" ")])})),1):[e._v("类型不支持")]:a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请输入"+t.name},on:{pressEnter:e.handleSearch}})],2)],1):e._e()})),e.advanced?e._l(e.searchFields,(function(t,r){return r>=e.size?a("a-col",{key:r,attrs:{md:e.cmd,sm:24}},[a("a-form-item",{attrs:{label:t.name}},[t.type&&"input"!==t.type?"select"===t.type?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+t.name}},e._l(t.list,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(e._s(t.label?t.label:t.value)+" ")])})),1):"date"===t.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+t.name}}):"datetime"===t.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{"show-time":"",placeholder:"请选择"+t.name}}):"radio"===t.type?a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}]},e._l(t.list,(function(t,r){return a("a-radio",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(" "+e._s(t.label?t.label:t.value)+" ")])})),1):[e._v("类型不支持")]:a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.code],expression:"[item.code]"}],attrs:{placeholder:"请输入"+t.name},on:{pressEnter:e.handleSearch}})],2)],1):e._e()})):e._e(),e.searchFields.length>e.size?a("a-col",{attrs:{md:!e.advanced&&e.cmd||24,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-right":"10px"},on:{click:e.handleReset}},[e._v("重置")]),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v(" "+e._s(e.advanced?"收起":"展开")+" "),a("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)]):a("a-col",{attrs:{md:e.cmd,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),a("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)])],2)],1)],1)},o=[],n=(a("d81d"),a("a9e3"),a("4042")),i={name:"SearchForm",data:function(){return{form:this.$form.createForm(this),advanced:!1,dateFmt:"YYYY-MM-DD",datetimeFmt:"YYYY-MM-DD HH:mm:ss"}},props:{searchFields:{type:Array},pmd:{type:Number,default:6}},computed:{cmd:function(){var e=this.pmd;return 6===e||8===e||12===e?e:6},size:function(){var e=this.pmd;return 6===e||8===e||12===e?24/e-1:3}},methods:{handleSearch:function(){var e=this,t=[],a=[];this.searchFields.map((function(e,r){"date"===e.type&&t.push(e.code),"datetime"===e.type&&a.push(e.code)}));var r=this.form.getFieldsValue();t.map((function(t){r[t]&&(r[t]=r[t].format(e.dateFmt))})),a.map((function(t){r[t]&&(r[t]=r[t].format(e.datetimeFmt))})),r=Object(n["b"])(r),this.$emit("search",r)},handleReset:function(){this.form.resetFields(),this.handleSearch()},toggleAdvanced:function(){this.advanced=!this.advanced}}},s=i,c=a("2877"),d=Object(c["a"])(s,r,o,!1,null,null,null);t["a"]=d.exports},4042:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));a("d81d"),a("b64b"),a("498a");function r(e){return void 0===e||null===e||""===e.trim()}function o(e){return!r(e)}function n(e){var t={};for(var a in e)o(e[a])&&(t[a]=e[a]);return t}var i=function(){return{title:"",mode:"",visible:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:19}}},confirmLoading:!1,form:{}}}},"7ad5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("keep-alive",["Role"===e.$route.name?a("a-card",{attrs:{bordered:!1}},[a("search-form",{attrs:{searchFields:e.searchFields},on:{search:e.handleSearchEvent}}),a("div",{staticClass:"table-operator"},[a("a-button",{directives:[{name:"action",rawName:"v-action:sysRole:add",arg:"sysRole:add"}],attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("a-table",{attrs:{bordered:!1,columns:e.columns,loading:e.loading,dataSource:e.data,pagination:e.pagination,rowKey:function(e){return e.id}},on:{change:e.handleChange},scopedSlots:e._u([{key:"state",fn:function(e){return[a("a-badge","ON"===e?{attrs:{status:"success"}}:{attrs:{status:"error"}})]}},{key:"action",fn:function(t){return[a("div",{staticClass:"row-operations"},[a("a-tooltip",{directives:[{name:"action",rawName:"v-action:sysRole:toggle",arg:"sysRole:toggle"}],attrs:{title:"ON"===t.state?"启用":"禁用"}},[a("a-switch",{attrs:{size:e.rowBtnSize,checked:"ON"===t.state},on:{change:function(a){return e.toggleState(t)}}})],1),a("a-button",{directives:[{name:"action",rawName:"v-action:sysRole:update",arg:"sysRole:update"}],staticClass:"rowBtn",attrs:{type:"link",size:e.rowBtnSize},on:{click:function(a){return e.handleEdit(t)}}},[e._v("编辑")]),a("a-button",{directives:[{name:"action",rawName:"v-action:sysRole:configResources",arg:"sysRole:configResources"}],staticClass:"rowBtn",attrs:{type:"link",size:e.rowBtnSize},on:{click:function(a){return e.handleConfigResources(t.id)}}},[e._v("配置资源")]),a("a-popconfirm",{directives:[{name:"action",rawName:"v-action:sysRole:remove",arg:"sysRole:remove"}],attrs:{placement:"top",title:"你确定要删除这条数据吗?",trigger:"hover",okText:"是",cancelText:"否"},on:{confirm:function(a){return e.handleRemove(t.id)}}},[a("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:e.rowBtnSize}},[e._v("删除")])],1)],1)]}}],null,!1,1777369682)}),a("a-modal",{attrs:{visible:e.modal.visible,title:e.modal.title,confirmLoading:e.modal.confirmLoading},on:{cancel:e.handleModalCancel,ok:e.handleModalOk}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"角色名"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入角色名!"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入角色名!' }]} ]"}]})],1),a("a-form-item",e._b({attrs:{label:"编码"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"请输入角色编码!"}]}],expression:"['id',{ rules: [{ required: true, message: '请输入角色编码!' }]} ]"}],attrs:{disabled:"edit"===e.modal.mode}})],1),a("a-form-item",e._b({attrs:{label:"状态"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["state",{rules:[{required:!0,message:"请选择状态!"}]}],expression:"['state',{ rules: [{ required: true, message: '请选择状态!' }]} ]"}]},[a("a-radio",{attrs:{value:"ON"}},[e._v("启用")]),a("a-radio",{attrs:{value:"OFF"}},[e._v("禁用")])],1)],1),a("a-form-item",e._b({attrs:{label:"简介"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro"],expression:"['intro']"}],attrs:{type:"textarea"}})],1)],1)],1)],1):e._e()],1),a("transition",{attrs:{name:"page-transition"}},[a("router-view")],1)],1)},o=[],n=(a("a4d3"),a("e01a"),a("4de4"),a("b0c0"),a("d3b7"),a("0187")),i=a("4042"),s=a("1afd"),c={name:"Role",components:{SearchForm:s["a"]},data:function(){return{description:"",form:this.$form.createForm(this),rowBtnSize:"small",loading:!1,columns:[{title:"状态",dataIndex:"state",align:"center",scopedSlots:{customRender:"state"}},{title:"角色名",dataIndex:"name"},{title:"角色编码",dataIndex:"id"},{title:"介绍",dataIndex:"intro"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],data:[],searchFields:[{name:"角色名称",code:"search_LIKE_name"},{name:"角色编码",code:"search_LIKE_id"}],pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},filter:{},modal:Object(i["a"])()}},created:function(){this.loadData()},watch:{$route:function(e,t){"RoleConfigResources"===e.name&&(this.description="左侧为 角色 ".concat(e.params.roleId," 未拥有资源，右侧为已拥有资源")),"Role"===e.name&&(this.description="")}},methods:{loadData:function(){var e=this;this.loading=!0;var t={filter:this.filter,current:this.pagination.current,pageSize:this.pagination.pageSize};Object(n["e"])(t).then((function(t){e.data=t.data.records,e.pagination.current=t.data.current,e.pagination.total=t.data.total,e.pagination.pageSize=t.data.pageSize})).finally((function(){e.loading=!1}))},handleSearchEvent:function(e){this.pagination.current=1,this.pagination.total=0,this.filter=e,this.loadData()},handleChange:function(e){this.pagination=e,this.loadData()},toggleState:function(e){var t=this;Object(n["i"])(e.id).then((function(e){e.status&&t.loadData()}))},handleAdd:function(){var e=this;this.modal.title="新增角色",this.modal.mode="add",this.modal.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({state:"ON"})}))},handleEdit:function(e){var t=this;this.modal.title="编辑角色",this.modal.mode="edit",this.modal.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({id:e.id,name:e.name,state:e.state,intro:e.intro})}))},handleConfigResources:function(e){this.$router.push({name:"RoleConfigResources",params:{roleId:e}})},handleRemove:function(e){var t=this;Object(n["h"])(e).then((function(e){e.status&&t.loadData()}))},handleModalOk:function(){var e=this;this.form.validateFields((function(t,a){t||(e.modal.confirmLoading=!0,"add"===e.modal.mode?Object(n["a"])(a).then(e.handleModalOkResult):"edit"===e.modal.mode&&Object(n["j"])(a.id,a).then(e.handleModalOkResult))}))},handleModalOkResult:function(e){this.modal.confirmLoading=!1,e.status&&(this.modal.visible=!1,this.form.resetFields(),this.loadData())},handleModalCancel:function(){this.form.resetFields(),this.modal.visible=!1}}},d=c,l=a("2877"),u=Object(l["a"])(d,r,o,!1,null,null,null);t["default"]=u.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["log"],{"63bf":function(e,t,a){},"7f78c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("a-card",{attrs:{bordered:!1}},[r("single-search-form",{attrs:{searchFields:t.searchFields},on:{search:t.handleSearchEvent},scopedSlots:t._u([t.checkPermission(["sysLog:remove"])?{key:"head",fn:function(){return[r("a-button",{attrs:{type:"danger",icon:"delete",loading:t.removeBtnLoading,disabled:0===t.selectedRowKeys.length},on:{click:t.handleRemove}},[t._v("删除")]),t.selectedRowKeys.length>0?[r("span",{staticStyle:{"margin-left":"5px"}},[t._v(" 已选中 "+t._s(t.selectedRowKeys.length)+" 条数据")])]:t._e()]},proxy:!0}:null],null,!0)}),r("a-table",{attrs:{bordered:!1,columns:t.columns,loading:t.loading,dataSource:t.data,size:t.tableSize,pagination:t.pagination,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:function(t){e.selectedRowKeys=t}},rowKey:function(e){return e.id}},on:{change:t.handleChange},scopedSlots:t._u([{key:"uri",fn:function(e,a){return[r("a-tag",{attrs:{color:"blue"}},[t._v(t._s(a.httpMethod))]),t._v(" "+t._s(e)+" ")]}},{key:"ope",fn:function(e){return[r("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:"small"},on:{click:function(a){return t.handleDetail(e)}}},[t._v("详情")])]}}])}),r("a-modal",{attrs:{title:t.detail.actionName,footer:null},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[r("a-row",[r("a-row",{staticClass:"label",attrs:{span:24}},[t._v("Class:")]),r("a-row",{staticClass:"value",attrs:{span:24}},[t._v(t._s(t.detail.classMethod))]),r("a-row",{staticClass:"label",attrs:{span:24}},[t._v("参数: ")]),r("a-row",{staticClass:"value",attrs:{span:24}},[t._v(t._s(t.detail.params))]),r("a-row",{staticClass:"label",attrs:{span:24}},[t._v("响应: ")]),r("a-row",{staticClass:"value",attrs:{span:24}},[t._v(t._s(t.detail.result))])],1)],1)],1)},s=[],i=(a("4de4"),a("d3b7"),a("b775")),o={list:"/sys/log/list",remove:"/sys/log/batch-remove"};function n(e){return Object(i["b"])({url:o.list,method:"post",data:e})}function c(e){return Object(i["b"])({url:"".concat(o.remove),method:"post",data:e})}var l=a("b4a5"),d={name:"Log",components:{SingleSearchForm:l["a"]},data:function(){return{loading:!1,removeBtnLoading:!1,columns:[{title:"URI",dataIndex:"uri",scopedSlots:{customRender:"uri"}},{title:"日志",dataIndex:"actionName"},{title:"用户",dataIndex:"username"},{title:"时间",dataIndex:"createTime"},{title:"IP",dataIndex:"ip"},{title:"操作",key:"ope",align:"right",scopedSlots:{customRender:"ope"}}],data:[],searchFields:[{name:"用户名",code:"search_LIKE_username"},{name:"内容",code:"search_LIKE_action_name"},{name:"IP地址",code:"search_LIKE_ip"}],pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},filter:{},selectedRowKeys:[],modalVisible:!1,detail:{}}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0;var t={filter:this.filter,order:{column:"create_time",sort:"desc"},current:this.pagination.current,pageSize:this.pagination.pageSize};n(t).then((function(t){e.data=t.data.records,e.pagination.current=t.data.current,e.pagination.total=t.data.total,e.pagination.pageSize=t.data.pageSize})).finally((function(){e.loading=!1}))},handleSearchEvent:function(e){this.pagination.current=1,this.pagination.total=0,this.filter=e,this.loadData()},handleChange:function(e){this.pagination=e,this.loadData()},handleRemove:function(){var e=this;this.removeBtnLoading=!0,c(this.selectedRowKeys).then((function(t){t.status&&(e.selectedRowKeys=[],e.loadData())})).finally((function(){e.removeBtnLoading=!1}))},handleDetail:function(e){this.detail=e,this.modalVisible=!0}}},u=d,m=(a("a527"),a("2877")),h=Object(m["a"])(u,r,s,!1,null,"3f751401",null);t["default"]=h.exports},"930a":function(e,t,a){},a527:function(e,t,a){"use strict";var r=a("63bf"),s=a.n(r);s.a},b4a5:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{ref:"searchForm",attrs:{layout:"inline",form:e.form}},[a("a-row",{attrs:{gutter:20}},[e.$slots.head&&e.desktop?a("a-col",{attrs:{md:8,xs:24}},[a("div",{staticClass:"table-page-search-headButtons"},[e._t("head")],2)]):e._e(),a("a-col",{attrs:{md:e.desktop?5:7,xs:24}},[a("a-form-item",{attrs:{label:"查询字段"}},[a("a-select",{attrs:{placeholder:"请选择查询字段"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.searchFields,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{md:e.desktop?8:11,xs:24}},[a("a-form-item",{attrs:{label:e.activeItem.name}},[e.activeItem.type&&"input"!==e.activeItem.type?"select"===e.activeItem.type?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请选择"+e.activeItem.name}},e._l(e.activeItem.list,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(e._s(t.label?t.label:t.value)+" ")])})),1):"date"===e.activeItem.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请选择"+e.activeItem.name}}):"datetime"===e.activeItem.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{"show-time":"",placeholder:"请选择"+e.activeItem.name}}):"radio"===e.activeItem.type?a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}]},e._l(e.activeItem.list,(function(t,r){return a("a-radio",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(" "+e._s(t.label?t.label:t.value)+" ")])})),1):[e._v("类型不支持")]:a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请输入"+e.activeItem.name},on:{pressEnter:e.handleSearch}})],2)],1),a("a-col",{class:{"align-right":e.desktop},attrs:{md:e.desktop?3:6,xs:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),a("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)])],1)],1)],1),e.$slots.head&&!e.desktop?a("div",{staticClass:"table-operator"},[e._t("head")],2):e._e()])},s=[],i=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),o=a("ca00"),n=a("5880"),c=a("51e6");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"SingleSearchForm",data:function(){return{form:this.$form.createForm(this),type:this.searchFields[0].code,dateFmt:"YYYY-MM-DD",datetimeFmt:"YYYY-MM-DD HH:mm:ss"}},props:{searchFields:{type:Array,required:!0}},computed:d({},Object(n["mapGetters"])(["device"]),{activeItem:function(){for(var e,t=this.searchFields,a=0;a<t.length;a++)if(this.type===t[a].code){e=t[a];break}return e||t[0]},desktop:function(){return this.device===c["a"].DESKTOP}}),methods:{handleSearch:function(){var e=this.form.getFieldsValue();"date"===this.activeItem.type?e[this.activeItem.code]=e[this.activeItem.code].format(this.dateFmt):"datetime"===this.activeItem.type&&(e[this.activeItem.code]=e[this.activeItem.code].format(this.datetimeFmt)),e=Object(o["b"])(e),this.$emit("search",e)},handleReset:function(){this.$slots.head;this.form.resetFields(),this.handleSearch()}}},m=u,h=(a("d167"),a("2877")),p=Object(h["a"])(m,r,s,!1,null,"5f3791dc",null);t["a"]=p.exports},d167:function(e,t,a){"use strict";var r=a("930a"),s=a.n(r);s.a}}]);
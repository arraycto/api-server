(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["log"],{"1afd":function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{ref:"searchForm",attrs:{layout:"inline",form:e.form}},[t("a-row",{attrs:{gutter:20}},[e._l(e.searchFields,(function(a,r){return r<e.size?t("a-col",{key:r,attrs:{md:e.cmd,sm:24}},[t("a-form-item",{attrs:{label:a.name}},[a.type&&"input"!==a.type?"select"===a.type?t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+a.name}},e._l(a.list,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value?a.value:a.label}},[e._v(e._s(a.label?a.label:a.value)+" ")])})),1):"date"===a.type?t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+a.name}}):"datetime"===a.type?t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{"show-time":"",placeholder:"请选择"+a.name}}):"radio"===a.type?t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}]},e._l(a.list,(function(a,r){return t("a-radio",{key:r,attrs:{value:a.value?a.value:a.label}},[e._v(" "+e._s(a.label?a.label:a.value)+" ")])})),1):[e._v("类型不支持")]:t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请输入"+a.name},on:{pressEnter:e.handleSearch}})],2)],1):e._e()})),e.advanced?e._l(e.searchFields,(function(a,r){return r>=e.size?t("a-col",{key:r,attrs:{md:e.cmd,sm:24}},[t("a-form-item",{attrs:{label:a.name}},[a.type&&"input"!==a.type?"select"===a.type?t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+a.name}},e._l(a.list,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value?a.value:a.label}},[e._v(e._s(a.label?a.label:a.value)+" ")])})),1):"date"===a.type?t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请选择"+a.name}}):"datetime"===a.type?t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{"show-time":"",placeholder:"请选择"+a.name}}):"radio"===a.type?t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}]},e._l(a.list,(function(a,r){return t("a-radio",{key:r,attrs:{value:a.value?a.value:a.label}},[e._v(" "+e._s(a.label?a.label:a.value)+" ")])})),1):[e._v("类型不支持")]:t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[a.code],expression:"[item.code]"}],attrs:{placeholder:"请输入"+a.name},on:{pressEnter:e.handleSearch}})],2)],1):e._e()})):e._e(),e.searchFields.length>e.size?t("a-col",{attrs:{md:!e.advanced&&e.cmd||24,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[t("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("a-button",{staticStyle:{"margin-right":"10px"},on:{click:e.handleReset}},[e._v("重置")]),t("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v(" "+e._s(e.advanced?"收起":"展开")+" "),t("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)]):t("a-col",{attrs:{md:e.cmd,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons"},[t("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)])],2)],1)],1)},n=[],o=(t("d81d"),t("a9e3"),t("4042")),s={name:"SearchForm",data:function(){return{form:this.$form.createForm(this),advanced:!1,dateFmt:"YYYY-MM-DD",datetimeFmt:"YYYY-MM-DD HH:mm:ss"}},props:{searchFields:{type:Array},pmd:{type:Number,default:6}},computed:{cmd:function(){var e=this.pmd;return 6===e||8===e||12===e?e:6},size:function(){var e=this.pmd;return 6===e||8===e||12===e?24/e-1:3}},methods:{handleSearch:function(){var e=this,a=[],t=[];this.searchFields.map((function(e,r){"date"===e.type&&a.push(e.code),"datetime"===e.type&&t.push(e.code)}));var r=this.form.getFieldsValue();a.map((function(a){r[a]&&(r[a]=r[a].format(e.dateFmt))})),t.map((function(a){r[a]&&(r[a]=r[a].format(e.datetimeFmt))})),r=Object(o["b"])(r),this.$emit("search",r)},handleReset:function(){this.form.resetFields(),this.handleSearch()},toggleAdvanced:function(){this.advanced=!this.advanced}}},i=s,l=t("2877"),c=Object(l["a"])(i,r,n,!1,null,null,null);a["a"]=c.exports},4042:function(e,a,t){"use strict";t.d(a,"b",(function(){return o})),t.d(a,"a",(function(){return s}));t("d81d"),t("b64b"),t("498a");function r(e){return void 0===e||null===e||""===e.trim()}function n(e){return!r(e)}function o(e){var a={};for(var t in e)n(e[t])&&(a[t]=e[t]);return a}var s=function(){return{title:"",mode:"",visible:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:19}}},confirmLoading:!1,form:{}}}},e03a:function(e,a,t){"use strict";var r=t("f992"),n=t.n(r);n.a},f992:function(e,a,t){},fbc1:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=this,t=a.$createElement,r=a._self._c||t;return r("a-card",{attrs:{bordered:!1}},[r("search-form",{attrs:{searchFields:a.searchFields},on:{search:a.handleSearchEvent}}),r("div",{staticClass:"table-operator"},[r("a-button",{directives:[{name:"action",rawName:"v-action:sysLog:remove",arg:"sysLog:remove"}],attrs:{type:"danger",icon:"delete",loading:a.removeBtnLoading,disabled:0===a.selectedRowKeys.length},on:{click:a.handleRemove}},[a._v("删除")]),a.selectedRowKeys.length>0?[a._v("已选中 "+a._s(a.selectedRowKeys.length)+" 条数据")]:a._e()],2),r("a-table",{attrs:{bordered:!1,columns:a.columns,loading:a.loading,dataSource:a.data,pagination:a.pagination,rowSelection:{selectedRowKeys:a.selectedRowKeys,onChange:function(a){e.selectedRowKeys=a}},rowKey:function(e){return e.id}},on:{change:a.handleChange},scopedSlots:a._u([{key:"uri",fn:function(e,t){return[r("a-tag",{attrs:{color:"blue"}},[a._v(a._s(t.httpMethod))]),a._v(" "+a._s(e)+" ")]}},{key:"ope",fn:function(e){return[r("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:a.rowBtnSize},on:{click:function(t){return a.handleDetail(e)}}},[a._v("详情")])]}}])}),r("a-modal",{attrs:{title:a.detail.actionName,footer:null},model:{value:a.modalVisible,callback:function(e){a.modalVisible=e},expression:"modalVisible"}},[r("a-row",[r("a-row",{staticClass:"label",attrs:{span:24}},[a._v("Class:")]),r("a-row",{staticClass:"value",attrs:{span:24}},[a._v(a._s(a.detail.classMethod))]),r("a-row",{staticClass:"label",attrs:{span:24}},[a._v("参数: ")]),r("a-row",{staticClass:"value",attrs:{span:24}},[a._v(a._s(a.detail.params))]),r("a-row",{staticClass:"label",attrs:{span:24}},[a._v("响应: ")]),r("a-row",{staticClass:"value",attrs:{span:24}},[a._v(a._s(a.detail.result))])],1)],1)],1)},n=[],o=(t("4de4"),t("d3b7"),t("b775")),s={list:"/sys/log/list",remove:"/sys/log/batch-remove"};function i(e){return Object(o["b"])({url:s.list,method:"post",data:e})}function l(e){return Object(o["b"])({url:"".concat(s.remove),method:"post",data:e})}var c=t("1afd"),d={name:"Log",components:{SearchForm:c["a"]},data:function(){return{rowBtnSize:"small",loading:!1,removeBtnLoading:!1,columns:[{title:"URI",dataIndex:"uri",scopedSlots:{customRender:"uri"}},{title:"日志",dataIndex:"actionName"},{title:"用户",dataIndex:"username"},{title:"时间",dataIndex:"createTime"},{title:"IP",dataIndex:"ip"},{title:"操作",key:"ope",scopedSlots:{customRender:"ope"}}],data:[],searchFields:[{name:"用户名",code:"search_LIKE_username"},{name:"内容",code:"search_LIKE_action_name"},{name:"IP地址",code:"search_LIKE_ip"}],pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},filter:{},selectedRowKeys:[],modalVisible:!1,detail:{}}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0;var a={filter:this.filter,order:{column:"create_time",sort:"desc"},current:this.pagination.current,pageSize:this.pagination.pageSize};i(a).then((function(a){e.data=a.data.records,e.pagination.current=a.data.current,e.pagination.total=a.data.total,e.pagination.pageSize=a.data.pageSize})).finally((function(){e.loading=!1}))},handleSearchEvent:function(e){this.pagination.current=1,this.pagination.total=0,this.filter=e,this.loadData()},handleChange:function(e){this.pagination=e,this.loadData()},handleRemove:function(){var e=this;this.removeBtnLoading=!0,l(this.selectedRowKeys).then((function(a){a.status&&(e.selectedRowKeys=[],e.loadData())})).finally((function(){e.removeBtnLoading=!1}))},handleDetail:function(e){this.detail=e,this.modalVisible=!0}}},u=d,m=(t("e03a"),t("2877")),p=Object(m["a"])(u,r,n,!1,null,"79ef5c2a",null);a["default"]=p.exports}}]);
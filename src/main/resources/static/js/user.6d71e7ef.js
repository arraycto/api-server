(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{4042:function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"a",(function(){return s}));e("d81d"),e("b64b"),e("498a");function r(t){return""===t||""===t.trim()||void 0===t||null===t}function o(t){return!r(t)}function n(t){var a={};for(var e in t)o(t[e])&&(a[e]=t[e]);return a}var s=function(){return{title:"",mode:"",visible:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:19}}},confirmLoading:!1,form:{}}}},"45d1":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",["User"===t.$route.name?e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"用户名"}},[e("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.query.search_LIKE_id,callback:function(a){t.$set(t.query,"search_LIKE_id",a)},expression:"query.search_LIKE_id"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"简介"}},[e("a-input",{attrs:{placeholder:"请输入描述"},model:{value:t.query.search_LIKE_intro,callback:function(a){t.$set(t.query,"search_LIKE_intro",a)},expression:"query.search_LIKE_intro"}})],1)],1),t.advanced?[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"手机号"}},[e("a-input",{attrs:{placeholder:"请输入手机号"},model:{value:t.query.search_LIKE_phone,callback:function(a){t.$set(t.query,"search_LIKE_phone",a)},expression:"query.search_LIKE_phone"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"邮箱"}},[e("a-input",{attrs:{placeholder:"请输入邮箱"},model:{value:t.query.search_LIKE_email,callback:function(a){t.$set(t.query,"search_LIKE_email",a)},expression:"query.search_LIKE_email"}})],1)],1)]:t._e(),e("a-col",{attrs:{md:t.advanced?24:6,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",style:t.advanced&&{float:"right",overflow:"hidden"}||{}},[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleSearch}},[t._v("查询")]),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"收起":"展开")+" "),e("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],2)],1)],1),e("div",{staticClass:"table-operator"},[e("a-button",{directives:[{name:"action",rawName:"v-action:sysUser:add",arg:"sysUser:add"}],attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新增")])],1),e("a-table",{attrs:{bordered:!1,columns:t.columns,loading:t.loading,defaultExpandAllRows:!0,dataSource:t.data,pagination:t.pagination,rowKey:function(t){return t.id}},on:{change:t.handleChange},scopedSlots:t._u([{key:"avatar",fn:function(a){return[e("a-avatar",{attrs:{src:t.fileServer+"/"+a}})]}},{key:"state",fn:function(t){return[e("a-badge","0"===t?{attrs:{status:"success"}}:{attrs:{status:"error"}})]}},{key:"action",fn:function(a){return[e("div",{staticClass:"editable-row-operations"},[e("a-tooltip",{directives:[{name:"action",rawName:"v-action:sysUser:toggle",arg:"sysUser:toggle"}],attrs:{title:"0"===a.state?"启用":"禁用"}},[e("a-switch",{attrs:{size:t.rowBtnSize,checked:"0"===a.state},on:{change:function(e){return t.toggleState(a)}}})],1),e("a-button",{directives:[{name:"action",rawName:"v-action:sysUser:update",arg:"sysUser:update"}],staticClass:"rowBtn",attrs:{size:t.rowBtnSize,type:"link"},on:{click:function(e){return t.handleEdit(a)}}},[t._v("编辑")]),e("a-button",{directives:[{name:"action",rawName:"v-action:sysUser:configRoles",arg:"sysUser:configRoles"}],staticClass:"rowBtn",attrs:{type:"link",size:t.rowBtnSize},on:{click:function(e){return t.handleConfigRoles(a.id)}}},[t._v("配置角色")]),e("a-popconfirm",{directives:[{name:"action",rawName:"v-action:sysUser:resetPwd",arg:"sysUser:resetPwd"}],attrs:{placement:"top",title:"确定重置此用户密码吗？",trigger:"hover",okText:"是",cancelText:"否"},on:{confirm:function(e){return t.handleResetPwd(a.id)}}},[e("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:t.rowBtnSize}},[t._v("重置密码")])],1),e("a-popconfirm",{directives:[{name:"action",rawName:"v-action:sysUser:remove",arg:"sysUser:remove"}],attrs:{placement:"top",title:"确定删除此数据吗？",trigger:"hover",okText:"是",cancelText:"否"},on:{confirm:function(e){return t.handleRemove(a.id)}}},[e("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:t.rowBtnSize}},[t._v("删除")])],1)],1)]}}],null,!1,767210100)}),e("a-modal",{attrs:{visible:t.modal.visible,title:t.modal.title,confirmLoading:t.modal.confirmLoading},on:{cancel:t.handleModalCancel,ok:t.handleModalOk}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",t._b({attrs:{label:"用户名"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"请输入用户名!"}]}],expression:"['id',{ rules: [{ required: true, message: '请输入用户名!' }]} ]"}],attrs:{disabled:"edit"===t.modal.mode}})],1),e("a-form-item",t._b({attrs:{label:"头像"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file",accept:"image/*",headers:t.uploadHeaders,listType:"picture-card",showUploadList:!1,action:t.fileServer+"/file/upload",beforeUpload:t.handleBeforeUpload},on:{change:t.handleUploadChange}},[t.modal.form.avatarUrl?e("img",{attrs:{src:t.modal.form.avatarUrl,width:"100px",alt:"avatar"}}):e("div",[e("a-icon",{attrs:{type:t.modal.form.avatarLoading?"loading":"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v("上传")])],1)])],1),e("a-form-item",t._b({attrs:{label:"手机号"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号!"}]}],expression:"['phone',{ rules: [{ required: true, message: '请输入手机号!' }]} ]"}]})],1),e("a-form-item",t._b({attrs:{label:"邮箱"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,message:"请输入邮箱!"}]}],expression:"['email',{ rules: [{ required: true, message: '请输入邮箱!' }]} ]"}]})],1),e("a-form-item",t._b({attrs:{label:"状态"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["state",{rules:[{required:!0,message:"请选择状态!"}]}],expression:"['state',{ rules: [{ required: true, message: '请选择状态!' }]} ]"}]},[e("a-radio",{attrs:{value:"0"}},[t._v("启用")]),e("a-radio",{attrs:{value:"1"}},[t._v("禁用")])],1)],1),e("a-form-item",t._b({attrs:{label:"简介"}},"a-form-item",t.modal.formItemLayout,!1),[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro"],expression:"['intro']"}],attrs:{type:"textarea"}})],1)],1)],1)],1):t._e(),e("transition",{attrs:{name:"page-transition"}},[e("router-view")],1)],1)},o=[],n=(e("a4d3"),e("e01a"),e("99af"),e("4de4"),e("b0c0"),e("d3b7"),e("8bbf")),s=e.n(n),i=e("9fb0"),l=e("8930"),d=e("4042"),c=Object(d["a"])();c.form.avatar="",c.form.avatarUrl=null,c.form.avatarLoading=!1;var u={name:"User",data:function(){return{description:"",form:this.$form.createForm(this),rowBtnSize:"small",loading:!1,columns:[{title:"状态",dataIndex:"state",align:"center",scopedSlots:{customRender:"state"}},{title:"头像",dataIndex:"avatar",align:"center",scopedSlots:{customRender:"avatar"}},{title:"用户名",dataIndex:"id"},{title:"昵称",dataIndex:"nickname"},{title:"简介",dataIndex:"intro"},{title:"电话",dataIndex:"phone",align:"left"},{title:"邮箱",dataIndex:"email",align:"left"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],data:[],advanced:!1,query:{search_LIKE_id:"",search_LIKE_intro:"",search_LIKE_phone:"",search_LIKE_email:""},pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},modal:c,uploadHeaders:{authorization:s.a.ls.get(i["a"])}}},computed:{filter:function(){return Object(d["b"])(this.query)}},watch:{$route:function(t,a){"UserConfigRoles"===t.name&&(this.description="左侧为 用户 ".concat(t.params.userId," 未拥有角色，右侧为已拥有角色")),"User"===t.name&&(this.description="")}},created:function(){this.loadData()},methods:{loadData:function(){var t=this;this.loading=!0;var a={filter:this.filter,current:this.pagination.current,pageSize:this.pagination.pageSize};Object(l["e"])(a).then((function(a){t.data=a.data.records,t.pagination.current=a.data.current,t.pagination.total=a.data.total,t.pagination.pageSize=a.data.pageSize})).finally((function(){t.loading=!1}))},handleUploadChange:function(t){var a=this;if("uploading"===t.file.status)return this.modal.form.avatarLoading=!0,void(this.modal.form.avatarUrl=null);"done"===t.file.status&&setTimeout((function(){a.modal.form.avatarLoading=!1,t.file.response.status&&(a.modal.form.avatarUrl="".concat(a.fileServer,"/").concat(t.file.response.data),a.modal.form.avatar=t.file.response.data)}),100)},handleBeforeUpload:function(t){var a="image/jpeg"===t.type,e="image/png"===t.type;a||e||this.$message.error("仅能上传  JPG/PNG 文件!");var r=t.size/1024/1024<2;return r||this.$message.error("上传文件必须小于 2MB!"),(a||e)&&r},handleSearch:function(){this.pagination.current=1,this.pagination.total=0,this.loadData()},handleChange:function(t){this.pagination=t,this.loadData()},toggleState:function(t){var a=this;Object(l["j"])(t.id).then((function(t){t.status&&a.loadData()}))},handleAdd:function(){var t=this;this.modal.title="新增用户",this.modal.mode="add",this.modal.visible=!0,this.modal.form.avatar="",this.modal.form.avatarUrl=null,this.modal.form.avatarLoading=!1,this.$nextTick((function(){t.form.setFieldsValue({state:"0"})}))},handleEdit:function(t){var a=this;this.modal.title="编辑用户",this.modal.mode="edit",this.modal.visible=!0,this.modal.form.avatar=t.avatar,this.modal.form.avatarUrl="".concat(this.fileServer,"/").concat(t.avatar),this.modal.form.avatarLoading=!1,this.$nextTick((function(){a.form.setFieldsValue({id:t.id,phone:t.phone,email:t.email,state:t.state,intro:t.intro})}))},handleConfigRoles:function(t){this.$router.push({name:"UserConfigRoles",params:{userId:t}})},handleResetPwd:function(t){var a=this;Object(l["i"])(t).then((function(t){t.status&&a.loadData()}))},handleRemove:function(t){var a=this;Object(l["h"])(t).then((function(t){t.status&&a.loadData()}))},handleModalOk:function(){var t=this;this.form.validateFields((function(a,e){a||(t.modal.confirmLoading=!0,e.avatar=t.modal.form.avatar,"add"===t.modal.mode?Object(l["a"])(e).then(t.handleModalOkResult):"edit"===t.modal.mode&&Object(l["k"])(e.id,e).then(t.handleModalOkResult))}))},handleModalOkResult:function(t){this.modal.confirmLoading=!1,t.status&&(this.modal.visible=!1,this.form.resetFields(),this.loadData())},handleModalCancel:function(){this.form.resetFields(),this.modal.visible=!1},toggleAdvanced:function(){this.advanced=!this.advanced}}},m=u,f=e("2877"),h=Object(f["a"])(m,r,o,!1,null,null,null);a["default"]=h.exports},8930:function(t,a,e){"use strict";e.d(a,"e",(function(){return n})),e.d(a,"a",(function(){return s})),e.d(a,"k",(function(){return i})),e.d(a,"h",(function(){return l})),e.d(a,"j",(function(){return d})),e.d(a,"i",(function(){return c})),e.d(a,"g",(function(){return u})),e.d(a,"f",(function(){return m})),e.d(a,"b",(function(){return f})),e.d(a,"c",(function(){return h})),e.d(a,"d",(function(){return p}));e("99af");var r=e("b775"),o={list:"/sys/user/list",add:"/sys/user/add",update:"/sys/user/update",remove:"/sys/user/remove",toggleState:"/sys/user/toggle-state",resetPwd:"/sys/user/reset-pwd",listNoRoles:"/sys/user/list-no-roles",listHaveRoles:"/sys/user/list-have-roles",addUserRoles:"/sys/user/add-user-roles",delUserRoles:"/sys/user/del-user-roles",detail:"/sys/user/detail"};function n(t){return Object(r["b"])({url:o.list,method:"post",data:t})}function s(t){return Object(r["b"])({url:o.add,method:"post",data:t})}function i(t,a){return Object(r["b"])({url:"".concat(o.update,"/").concat(t),method:"post",data:a})}function l(t){return Object(r["b"])({url:"".concat(o.remove,"/").concat(t),method:"get"})}function d(t){return Object(r["b"])({url:"".concat(o.toggleState,"/").concat(t),method:"get"})}function c(t){return Object(r["b"])({url:"".concat(o.resetPwd,"/").concat(t),method:"get"})}function u(t,a){return Object(r["b"])({url:"".concat(o.listNoRoles,"/").concat(t),method:"post",data:a})}function m(t,a){return Object(r["b"])({url:"".concat(o.listHaveRoles,"/").concat(t),method:"post",data:a})}function f(t,a){return Object(r["b"])({url:"".concat(o.addUserRoles,"/").concat(t),method:"post",data:a})}function h(t,a){return Object(r["b"])({url:"".concat(o.delUserRoles,"/").concat(t),method:"post",data:a})}function p(t){return Object(r["b"])({url:"".concat(o.detail,"/").concat(t),method:"get"})}}}]);
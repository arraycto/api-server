(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dataDict"],{"4b90":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:20}},[t.checkPermission(["sysDict:add"])?a("a-col",{attrs:{md:10,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新增")])],1)]):t._e(),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"方式"}},[a("a-select",{on:{change:t.handleTypeChange},model:{value:t.query.type,callback:function(e){t.$set(t.query,"type",e)},expression:"query.type"}},[a("a-select-option",{attrs:{value:"LIKE"}},[t._v("模糊")]),a("a-select-option",{attrs:{value:"EQ"}},[t._v("精确")])],1)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"LIKE"===t.query.type?"名称/编码":"编码"}},[a("a-input",{attrs:{placeholder:"LIKE"===t.query.type?"模糊查找不带层级结构":"精确查找带层级结构"},on:{pressEnter:t.handleSearch},model:{value:t.query.key,callback:function(e){t.$set(t.query,"key",e)},expression:"query.key"}})],1)],1),a("a-col",{attrs:{md:2,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v(" 查询")])],1)])],1)],1)],1),a("a-table",{attrs:{bordered:!1,columns:t.columns,loading:t.loading,dataSource:t.data,size:t.tableSize,pagination:t.pagination,rowKey:function(t){return t.id}},on:{change:t.handleChange},scopedSlots:t._u([{key:"type",fn:function(e){return["btn"===e?[t._v("按钮")]:[t._v("菜单")]]}},{key:"state",fn:function(t){return[a("a-badge","ON"===t?{attrs:{status:"success"}}:{attrs:{status:"error"}})]}},{key:"action",fn:function(e){return[a("div",{staticClass:"row-operations"},[a("a-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:["sysDict:toggle"],expression:"['sysDict:toggle']"}],attrs:{title:"ON"===e.state?"启用":"禁用"}},[a("a-switch",{attrs:{size:"small",checked:"ON"===e.state},on:{change:function(a){return t.toggleState(e)}}})],1),a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:["sysDict:add"],expression:"['sysDict:add']"}],staticClass:"rowBtn",attrs:{type:"link",size:"small"},on:{click:function(a){return t.handleAddChildren(e)}}},[t._v("添加下级")]),a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:["sysDict:update"],expression:"['sysDict:update']"}],staticClass:"rowBtn",attrs:{type:"link",size:"small"},on:{click:function(a){return t.handleEdit(e)}}},[t._v("编辑")]),a("a-popconfirm",{directives:[{name:"permission",rawName:"v-permission",value:["sysDict:remove"],expression:"['sysDict:remove']"}],attrs:{placement:"top",title:"你确定要删除这条数据吗?",trigger:"hover",okText:"是",cancelText:"否"},on:{confirm:function(a){return t.handleRemove(e.id)}}},[a("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:"small"}},[t._v("删除")])],1)],1)]}}])}),a("a-modal",{attrs:{visible:t.modal.visible,title:t.modal.title,confirmLoading:t.modal.confirmLoading},on:{cancel:t.handleModalCancel,ok:t.handleModalOk}},[a("a-form",{attrs:{form:t.form}},["edit"===t.modal.mode?a("a-form-item",t._b({staticClass:"hidden",attrs:{label:"上级组"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}]})],1):t._e(),a("a-form-item",t._b({attrs:{label:"上级组"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["pid",{rules:[{required:!0,message:"请选择上级组!"}]}],expression:"['pid',{ rules: [{ required: true, message: '请选择上级组!' }]} ]"}],attrs:{showSearch:"",treeNodeFilterProp:"title",dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:t.treeData,placeholder:"请选择上级组"}})],1),a("a-form-item",t._b({attrs:{label:"名称"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入名称!"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入名称!' }]} ]"}]})],1),a("a-form-item",t._b({attrs:{label:"编码"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{rules:[{required:!0,message:"请输入编码!"}]}],expression:"['code',{ rules: [{ required: true, message: '请输入编码!' }]} ]"}]})],1),a("a-form-item",t._b({attrs:{label:"排序号"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{rules:[{required:!0,message:"请输入排序号!"}]}],expression:"['sort',{ rules: [{ required: true, message: '请输入排序号!' }]} ]"}],attrs:{min:0}})],1),a("a-form-item",t._b({attrs:{label:"状态"}},"a-form-item",t.modal.formItemLayout,!1),[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["state",{rules:[{required:!0,message:"请选择状态!"}]}],expression:"['state',{ rules: [{ required: true, message: '请选择状态!' }]} ]"}]},[a("a-radio",{attrs:{value:"ON"}},[t._v("启用")]),a("a-radio",{attrs:{value:"OFF"}},[t._v("禁用")])],1)],1)],1)],1)],1)},r=[],s=(a("4de4"),a("4e82"),a("b0c0"),a("d3b7"),a("99af"),a("b775")),o={list:"/sys/data-dict/list",listTreeData:"/sys/data-dict/list-tree-select",add:"/sys/data-dict/add",update:"/sys/data-dict/update",remove:"/sys/data-dict/remove",toggleState:"/sys/data-dict/toggle-state"};function n(t){return Object(s["b"])({url:o.list,method:"post",data:t})}function d(t){var e=t?"".concat(o.listTreeData,"/").concat(t):o.listTreeData;return Object(s["b"])({url:e,method:"get"})}function l(t){return Object(s["b"])({url:o.add,method:"post",data:t})}function c(t,e){return Object(s["b"])({url:"".concat(o.update,"/").concat(t),method:"post",data:e})}function m(t){return Object(s["b"])({url:"".concat(o.remove,"/").concat(t),method:"get"})}function u(t){return Object(s["b"])({url:"".concat(o.toggleState,"/").concat(t),method:"get"})}var h=a("ca00"),p={name:"DataDict",data:function(){return{form:this.$form.createForm(this),loading:!1,columns:[{title:"名称",dataIndex:"name"},{title:"编码",dataIndex:"code"},{title:"排序号",dataIndex:"sort"},{title:"状态",dataIndex:"state",align:"center",scopedSlots:{customRender:"state"}},{title:"操作",key:"action",align:"right",scopedSlots:{customRender:"action"}}],data:[],treeData:[],query:{type:"LIKE",key:""},pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},modal:Object(h["c"])()}},computed:{filter:function(){return Object(h["b"])(this.query)}},created:function(){this.loadData()},methods:{loadData:function(){var t=this;this.loading=!0;var e={filter:this.filter,current:this.pagination.current,pageSize:this.pagination.pageSize};n(e).then((function(e){t.data=e.data.records,t.pagination.current=e.data.current,t.pagination.total=e.data.total,t.pagination.pageSize=e.data.pageSize})).finally((function(){t.loading=!1}))},loadTreeData:function(t){var e=this;d(t).then((function(t){t.status&&(e.treeData=[t.data])})).catch((function(t){}))},handleTypeChange:function(t){this.query.key="","LIKE"===t?this.$message.info("模糊查找不带层级结构"):this.$message.info("精确查找带层级结构, 仅能通过编码查询")},handleSearch:function(){this.pagination.current=1,this.pagination.total=0,this.loadData()},handleChange:function(t){this.pagination=t,this.loadData()},handleAdd:function(){var t=this;this.modal.title="新增",this.modal.mode="add",this.loadTreeData(),this.modal.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({pid:"0",sort:0,state:"ON"})}))},toggleState:function(t){var e=this;u(t.id).then((function(t){t.status&&e.loadData()}))},handleEdit:function(t){var e=this;this.modal.title="编辑",this.modal.mode="edit",this.loadTreeData(t.id),this.modal.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({id:t.id,pid:t.pid,name:t.name,code:t.code,state:t.state,sort:t.sort})}))},handleAddChildren:function(t){var e=this;this.modal.title="新增下级",this.modal.mode="addChildren",this.loadTreeData(),this.modal.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({pid:t.id,state:"ON",sort:t.children?t.children[t.children.length-1].sort+1:0})}))},handleRemove:function(t){var e=this;m(t).then((function(t){t.status&&e.loadData()}))},handleModalOk:function(){var t=this;this.form.validateFields((function(e,a){e||(t.modal.confirmLoading=!0,"add"===t.modal.mode||"addChildren"===t.modal.mode?l(a).then(t.handleModalOkResult):"edit"===t.modal.mode&&c(a.id,a).then(t.handleModalOkResult))}))},handleModalOkResult:function(t){this.modal.confirmLoading=!1,t.status&&(this.modal.visible=!1,this.form.resetFields(),this.loadData())},handleModalCancel:function(){this.form.resetFields(),this.modal.visible=!1}}},f=p,v=a("2877"),g=Object(v["a"])(f,i,r,!1,null,null,null);e["default"]=g.exports}}]);
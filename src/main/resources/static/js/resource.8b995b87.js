(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["resource"],{"6ac8":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("single-search-form",{attrs:{searchFields:e.searchFields},on:{search:e.handleSearchEvent},scopedSlots:e._u([e.checkPermission(["sysResource:add"])?{key:"head",fn:function(){return[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])]},proxy:!0}:null],null,!0)}),a("a-table",{attrs:{bordered:!1,columns:e.columns,loading:e.loading,size:e.tableSize,dataSource:e.data,pagination:e.pagination,rowKey:function(e){return e.id}},on:{change:e.handleChange},scopedSlots:e._u([{key:"type",fn:function(t){return["btn"===t?[e._v("按钮")]:[e._v("菜单")]]}},{key:"state",fn:function(e){return[a("a-badge","ON"===e?{attrs:{status:"success"}}:{attrs:{status:"error"}})]}},{key:"action",fn:function(t){return[a("div",{staticClass:"row-operations"},[a("a-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:["sysResource:toggle"],expression:"['sysResource:toggle']"}],attrs:{title:"ON"===t.state?"启用":"禁用"}},[a("a-switch",{attrs:{size:"small",checked:"ON"===t.state},on:{change:function(a){return e.toggleState(t)}}})],1),"menu"===t.type?a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:["sysResource:add"],expression:"['sysResource:add']"}],staticClass:"rowBtn",attrs:{type:"link",size:"small"},on:{click:function(a){return e.handleAddChildren(t)}}},[e._v("添加下级")]):e._e(),a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:["sysResource:update"],expression:"['sysResource:update']"}],staticClass:"rowBtn",attrs:{type:"link",size:"small"},on:{click:function(a){return e.handleEdit(t)}}},[e._v("编辑")]),a("a-popconfirm",{directives:[{name:"permission",rawName:"v-permission",value:["sysResource:remove"],expression:"['sysResource:remove']"}],attrs:{placement:"top",title:"你确定要删除这条数据吗?",trigger:"hover",okText:"是",cancelText:"否"},on:{confirm:function(a){return e.handleRemove(t.id)}}},[a("a-button",{staticClass:"rowBtn",attrs:{type:"link",size:"small"}},[e._v("删除")])],1)],1)]}}])}),a("a-modal",{attrs:{visible:e.modal.visible,title:e.modal.title,confirmLoading:e.modal.confirmLoading},on:{cancel:e.handleModalCancel,ok:e.handleModalOk}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"类型"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择资源类型!"}]}],expression:"['type',{ rules: [{ required: true, message: '请选择资源类型!' }]} ]"}],attrs:{disabled:"edit"===e.modal.mode}},[a("a-radio",{attrs:{value:"menu",disabled:"addChildren"===e.modal.mode}},[e._v("菜单")]),a("a-radio",{attrs:{value:"btn",disabled:"add"===e.modal.mode}},[e._v("按钮")])],1)],1),a("a-form-item",e._b({attrs:{label:"名称"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入资源名称!"}]}],expression:"['name',{ rules: [{ required: true, message: '请输入资源名称!' }]} ]"}]})],1),a("a-form-item",e._b({attrs:{label:"权限编码"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"请输入资源权限编码!"}]}],expression:"['id',{ rules: [{ required: true, message: '请输入资源权限编码!' }]} ]"}],attrs:{disabled:"edit"===e.modal.mode}})],1),a("a-form-item",e._b({attrs:{label:"排序号"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{rules:[{required:!0,message:"请输入排序号!"}]}],expression:"['sort',{ rules: [{ required: true, message: '请输入排序号!' }]} ]"}],attrs:{min:0}})],1),a("a-form-item",e._b({attrs:{label:"状态"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["state",{rules:[{required:!0,message:"请选择状态!"}]}],expression:"['state',{ rules: [{ required: true, message: '请选择状态!' }]} ]"}]},[a("a-radio",{attrs:{value:"ON"}},[e._v("启用")]),a("a-radio",{attrs:{value:"OFF"}},[e._v("禁用")])],1)],1),a("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.modal.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark']"}],attrs:{type:"textarea"}})],1)],1)],1)],1)},o=[],s=(a("4de4"),a("4e82"),a("b0c0"),a("d3b7"),a("99af"),a("b775")),i={list:"/sys/resource/list",add:"/sys/resource/add",update:"/sys/resource/update",remove:"/sys/resource/remove",toggleState:"/sys/resource/toggle-state"};function n(e){return Object(s["b"])({url:i.list,method:"post",data:e})}function d(e){return Object(s["b"])({url:i.add,method:"post",data:e})}function c(e,t){return Object(s["b"])({url:"".concat(i.update,"/").concat(e),method:"post",data:t})}function l(e){return Object(s["b"])({url:"".concat(i.remove,"/").concat(e),method:"get"})}function m(e){return Object(s["b"])({url:"".concat(i.toggleState,"/").concat(e),method:"get"})}var u=a("ca00"),h=a("b4a5"),p={name:"Resource",components:{SingleSearchForm:h["a"]},data:function(){return{form:this.$form.createForm(this),loading:!1,columns:[{title:"资源名称",dataIndex:"name"},{title:"权限标识",dataIndex:"id"},{title:"类型",dataIndex:"type",scopedSlots:{customRender:"type"}},{title:"排序号",dataIndex:"sort"},{title:"状态",dataIndex:"state",align:"center",scopedSlots:{customRender:"state"}},{title:"操作",key:"action",align:"right",scopedSlots:{customRender:"action"}}],data:[],searchFields:[{name:"资源名称",code:"search_LIKE_name"},{name:"权限标识",code:"search_LIKE_id"}],pagination:{showSizeChanger:!0,total:0,current:1,pageSize:10},filter:{},modal:Object(u["c"])()}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0;var t={filter:this.filter,orders:[{column:"sort",sort:"asc"},{column:"id",sort:"asc"}],current:this.pagination.current,pageSize:this.pagination.pageSize};n(t).then((function(t){e.data=t.data.records,e.pagination.current=t.data.current,e.pagination.total=t.data.total,e.pagination.pageSize=t.data.pageSize})).finally((function(){e.loading=!1}))},handleSearchEvent:function(e){this.pagination.current=1,this.pagination.total=0,this.filter=e,this.loadData()},handleChange:function(e){this.pagination=e,this.loadData()},handleAdd:function(){var e=this;this.modal.title="新增资源",this.modal.mode="add",this.modal.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({type:"menu",state:"ON",sort:1})}))},toggleState:function(e){var t=this;m(e.id).then((function(e){e.status&&t.loadData()}))},handleEdit:function(e){var t=this;this.modal.title="编辑资源",this.modal.mode="edit",this.modal.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({id:e.id,type:e.type,name:e.name,state:e.state,sort:e.sort,remark:e.remark})}))},handleAddChildren:function(e){var t=this;this.modal.title="新增下级按钮",this.modal.mode="addChildren",this.modal.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({id:e.id+":",type:"btn",state:"ON",sort:e.children?e.children[e.children.length-1].sort+1:0})}))},handleRemove:function(e){var t=this;l(e).then((function(e){e.status&&t.loadData()}))},handleModalOk:function(){var e=this;this.form.validateFields((function(t,a){t||(e.modal.confirmLoading=!0,"add"===e.modal.mode||"addChildren"===e.modal.mode?d(a).then(e.handleModalOkResult):"edit"===e.modal.mode&&c(a.id,a).then(e.handleModalOkResult))}))},handleModalOkResult:function(e){this.modal.confirmLoading=!1,e.status&&(this.modal.visible=!1,this.form.resetFields(),this.loadData())},handleModalCancel:function(){this.form.resetFields(),this.modal.visible=!1}}},v=p,f=a("2877"),b=Object(f["a"])(v,r,o,!1,null,null,null);t["default"]=b.exports},"930a":function(e,t,a){},b4a5:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{ref:"searchForm",attrs:{layout:"inline",form:e.form}},[a("a-row",{attrs:{gutter:20}},[e.$slots.head&&e.desktop?a("a-col",{attrs:{md:8,xs:24}},[a("div",{staticClass:"table-page-search-headButtons"},[e._t("head")],2)]):e._e(),a("a-col",{attrs:{md:e.desktop?5:7,xs:24}},[a("a-form-item",{attrs:{label:"查询字段"}},[a("a-select",{attrs:{placeholder:"请选择查询字段"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.searchFields,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{md:e.desktop?8:11,xs:24}},[a("a-form-item",{attrs:{label:e.activeItem.name}},[e.activeItem.type&&"input"!==e.activeItem.type?"select"===e.activeItem.type?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请选择"+e.activeItem.name}},e._l(e.activeItem.list,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(e._s(t.label?t.label:t.value)+" ")])})),1):"date"===e.activeItem.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请选择"+e.activeItem.name}}):"datetime"===e.activeItem.type?a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{"show-time":"",placeholder:"请选择"+e.activeItem.name}}):"radio"===e.activeItem.type?a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}]},e._l(e.activeItem.list,(function(t,r){return a("a-radio",{key:r,attrs:{value:t.value?t.value:t.label}},[e._v(" "+e._s(t.label?t.label:t.value)+" ")])})),1):[e._v("类型不支持")]:a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.activeItem.code],expression:"[activeItem.code]"}],attrs:{placeholder:"请输入"+e.activeItem.name},on:{pressEnter:e.handleSearch}})],2)],1),a("a-col",{class:{"align-right":e.desktop},attrs:{md:e.desktop?3:6,xs:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),a("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)])],1)],1)],1),e.$slots.head&&!e.desktop?a("div",{staticClass:"table-operator"},[e._t("head")],2):e._e()])},o=[],s=(a("a4d3"),a("4de4"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3")),i=a("ca00"),n=a("5880"),d=a("51e6");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={name:"SingleSearchForm",data:function(){return{form:this.$form.createForm(this),type:this.searchFields[0].code,dateFmt:"YYYY-MM-DD",datetimeFmt:"YYYY-MM-DD HH:mm:ss"}},props:{searchFields:{type:Array,required:!0}},computed:l({},Object(n["mapGetters"])(["device"]),{activeItem:function(){for(var e,t=this.searchFields,a=0;a<t.length;a++)if(this.type===t[a].code){e=t[a];break}return e||t[0]},desktop:function(){return this.device===d["a"].DESKTOP}}),methods:{handleSearch:function(){var e=this.form.getFieldsValue();"date"===this.activeItem.type?e[this.activeItem.code]=e[this.activeItem.code].format(this.dateFmt):"datetime"===this.activeItem.type&&(e[this.activeItem.code]=e[this.activeItem.code].format(this.datetimeFmt)),e=Object(i["b"])(e),this.$emit("search",e)},handleReset:function(){this.$slots.head;this.form.resetFields(),this.handleSearch()}}},u=m,h=(a("d167"),a("2877")),p=Object(h["a"])(u,r,o,!1,null,"5f3791dc",null);t["a"]=p.exports},d167:function(e,t,a){"use strict";var r=a("930a"),o=a.n(r);o.a}}]);